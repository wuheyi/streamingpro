webpackJsonp([1],{0:function(e,t){},L8S8:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7+uW"),r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var i=n("VU/8")({name:"App"},r,!1,function(e){n("QdoG")},null,null).exports,s=n("/ocq"),a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"div-table"},[n("div",{staticClass:"div-table-row"},e._l(e.columns,function(t,o){return n("div",{staticClass:"div-table-col"},[e._v(e._s(t))])})),e._v(" "),e._l(e.tableData,function(t,o){return n("div",{staticClass:"div-table-row"},e._l(t,function(t,o){return n("div",{staticClass:"div-table-col"},[e._v(e._s(t))])}))})],2)},staticRenderFns:[]};var l=n("VU/8")({name:"Table",props:["columns","tableData"],data:function(){return{}}},a,!1,function(e){n("cOlk")},"data-v-6c8eb09a",null).exports,u={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("Loading........")])},staticRenderFns:[]};var c=n("VU/8")({name:"Loading"},u,!1,function(e){n("L8S8")},"data-v-241276bc",null).exports,d=n("T1ft"),v=n.n(d),h=n("Zrlr"),m=n.n(h),_=n("wxAW"),f=n.n(_),p=function(){function e(t){m()(this,e),this._holder=t}return f()(e,[{key:"register",value:function(){var t={identifierRegexps:[/[^\s]+/],getCompletions:function(t,n,o,r,i){i(null,e.keywords().concat(e.datasources(),e.models()).filter(function(e){return e.includes(r)}).map(function(e){return{value:e,meta:"code"}}))}};this._holder.lang_tools().addCompleter(t)}}],[{key:"keywords",value:function(){return["load","save","train","register","options","connect","options","partitionBy","append","overwrite","errorIfExists","ignore",""]}},{key:"datasources",value:function(){return["parquet","json","csv","image"]}},{key:"models",value:function(){return["PythonAlg","ConfusionMatrix","TfIdfInPlace","RateSampler"]}},{key:"functions",value:function(){return["onehot"]}}]),e}(),g=function(){function e(t){m()(this,e),this._holder=t}return f()(e,[{key:"selection",value:function(){var e=this._holder.editor(),t=e.getSelectionRange();return e.session.getTextRange(t)}}]),e}(),b=function(){function e(t){m()(this,e),this._ace=n("kX7f");var o=t.$children.filter(function(e){return"editor"===e.$options._componentTag})[0];this._editor=o.editor,this._lang_tool=this._ace.acequire("ace/ext/language_tools"),this._tool=new g(this)}return f()(e,[{key:"tool",value:function(){return this._tool}},{key:"editor",value:function(){return this._editor}},{key:"lang_tools",value:function(){return this._lang_tool}},{key:"ace",value:function(){return this._ace}}]),e}(),w=function(){function e(t){m()(this,e),this._holder=t.holder}return f()(e,[{key:"register",value:function(){var e=this._holder;e.editor().commands.addCommand({name:"expand",bindKey:{win:"Tab",mac:"Tab"},exec:function(t){var n=t.getCursorPosition(),o=t.session.getLine(n.row),r=e.ace().acequire("ace/range").Range;"load"===o.trim()&&t.session.replace(new r(n.row,0,n.row,n.column),"load parquet.`[path]`\noptions [key]=[value]\nas [tableName];\n"),"save"===o.trim()&&t.session.replace(new r(n.row,0,n.row,n.column),"save append [tableName] as parquet.`[path]`\noptions [key]=[value]\npartitionBy [column];\n"),"train"===o.trim()&&t.session.replace(new r(n.row,0,n.row,n.column),"train [tableName] [moduleName].`[path]` where [key]=[value];\n"),"register"===o.trim()&&t.session.replace(new r(n.row,0,n.row,n.column),"register [moduleName].`[path]` as [functionName] options [key]=[value];\n")}})}}]),e}(),k=n("kKhF"),y=function(){function e(t){m()(this,e),this.main=t,this._holder=t.holder}return f()(e,[{key:"register",value:function(){this._holder,this._holder.editor().getSession()}},{key:"getTrainLine",value:function(){var e=this._holder.ace().acequire("ace/range").Range,t=this._holder.editor(),n=t.getSession(),o=t.getCursorPosition(),r=n.getTextRange(new e(0,0,o.row,o.column));console.log(k(r).split(";")),console.log(r)}},{key:"isTrain",value:function(){}}]),e}(),x=n("DtRx"),C={name:"Query",data:function(){return{msg:"MLSQL is cool",content:"select 1 as a,'jack' as b as bbc;",editor_options:{enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0},resource:{job_url:"/run/script",kill_job_url:"/killjob"},holder:{},result:{columns:[],tableData:[],msg:"",loading:!1,editor_modes:[{id:0,label:"正常模式"},{id:1,label:"vim模式"}],editor_mode_selected:{id:0,label:"正常模式"}},completer:{show:!1}}},methods:{editorInit:function(){n("R3yc"),n("2i/5"),n("QWRE");this.holder=new b(this),new p(this.holder).register(),new w(this).register(),new y(this).register()},submitRunSQL:function(e){var t=this.resource.job_url,n=this;n.jobName=x(),n.result.loading=!0,n.result.tableData=[],n.result.columns=[],n.result.msg="";var o=n.holder.tool().selection(),r=n.content;""!=o&&(r=o),n.$http.post(t,{sql:r,owner:"admin",jobName:n.jobName},{emulateJSON:!0}).then(function(e){n.result.loading=!1;var t=e.data,o=[],r={};t.forEach(function(e){for(var t in e)r[t]||(o.push(t),r[t]=!0)}),n.result.columns=o,n.result.tableData=[],t.forEach(function(e){var t={};o.forEach(function(n){t[n]=e[n]}),n.result.tableData.push(t)})},function(e){n.result.loading=!1,n.result.msg=e.bodyText})},cancelJob:function(e){var t=this.resource.kill_job_url,n=this;n.$http.post(t,{jobName:n.jobName},{emulateJSON:!0}).then(function(e){n.result.loading=!1,n.result.msg="the job is aborded success"},function(e){n.result.loading=!1})}},components:{editor:n("o4sT"),vtable:l,vloading:c,vSelect:v.a}},R={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"query_box"},[n("div",{staticClass:"editor_mode_select"},[n("span",[e._v("编辑器模式")]),e._v(":\n    "),n("vSelect",{attrs:{options:e.result.editor_modes},model:{value:e.result.editor_mode_selected,callback:function(t){e.$set(e.result,"editor_mode_selected",t)},expression:"result.editor_mode_selected"}})],1),e._v(" "),n("div",{staticClass:"dropdown-menu"},[e.completer.show?n("vSelect",{attrs:{options:e.result.editor_modes},model:{value:e.result.editor_mode_selected,callback:function(t){e.$set(e.result,"editor_mode_selected",t)},expression:"result.editor_mode_selected"}}):e._e()],1),e._v(" "),n("div",{attrs:{id:"editor"}},[n("editor",{attrs:{lang:"sql",theme:"twilight",width:"100%",height:"300px",options:e.editor_options},on:{init:e.editorInit},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),e._v(" "),n("div",[n("button",{staticClass:"btn btn-run waves-effect",attrs:{id:"runButton"},on:{click:e.submitRunSQL}},[e._v("运行")]),e._v(" "),n("button",{staticClass:"btn btn-cancel waves-effect",on:{click:e.cancelJob}},[e._v("取消")])]),e._v(" "),e.result.loading?n("vloading"):e._e()],1),e._v(" "),n("div",{attrs:{id:"show_result"}},[""!=e.result.msg?n("editor",{attrs:{lang:"text",width:"100%",height:"100px"},model:{value:e.result.msg,callback:function(t){e.$set(e.result,"msg",t)},expression:"result.msg"}}):e._e(),e._v(" "),e.result.tableData.length>0?n("vtable",{attrs:{"table-data":e.result.tableData,columns:e.result.columns}}):e._e()],1)])},staticRenderFns:[]};var N=n("VU/8")(C,R,!1,function(e){n("egM5")},"data-v-2801b6b9",null).exports;o.a.use(s.a);var S=new s.a({routes:[{path:"/",name:"Query",component:N}]}),j=n("8+8L");o.a.config.productionTip=!1,o.a.use(j.a),o.a.http.options.xhr={withCredentials:!0},new o.a({el:"#app",router:S,components:{App:i},template:"<App/>"})},QdoG:function(e,t){},cOlk:function(e,t){},egM5:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.c784d4a2ab569621979f.js.map